<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link rel="stylesheet" href="./css/main.css" />
</head>

<body>
  <div class="container">
    <h2 class="test">javaScript</h2>

    <div class="todoList-ct">
      <form id="todo-form" class="todoList-ct__Form" action="">
        <input id="todo-input" class="todoList-ct__Form__inputTag" type="text" />
      </form>

      <ul id="todo-list" class="todo-list"></ul>

      <div class="footer">
        <p class="footer__text count-item">ì˜¤ëŠ˜ í•  ì¼ 0ê°œ</p>
        <p class="all-item footer__text">ì „ì²´ë³´ê¸°</p>
        <p class="footer__text active-item">ë‚¨ì€ í•  ì¼</p>
        <p class="footer__text completed-item">ì™„ë£Œ í•œ ì¼</p>
        <!-- <p class="footer__text clear-item">ì™„ë£Œ ì§€ìš°ê¸°</p> -->
      </div>
    </div>
  </div>

  <div class="container" id="app"></div>

  <script type="module" src="./todo.js"></script>
  <!-- react dom ë¼ì´ë¸ŒëŸ¬ë¦¬ ë„£ì–´ì£¼ê¸° -->
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>

  <!-- jsxë¥¼ ë„ì™€ì£¼ëŠ” babel ë„£ì–´ì£¼ê¸° -->
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

  <!-- <script type="module" defer src="./todo.js"></script> -->
  <script type="text/babel">
    //ì»´í¬ë„ŒíŠ¸ëŠ” ëŒ€ë¬¸ìë¡œ ì‹œì‘í•œë‹¤.

      const App = () => {
        const [userName, setUserName] = React.useState(['Genie']);
        const [todoItemList, setTodoItemList] = React.useState([]);
        
        
        const TodoListForm = () => {
          
          const [text,setText] = React.useState("");
        
          const onChange = (e) => {
            setText(e.target.value);
          }

          
          //ì•„ì´í…œ ì¶”ê°€
          const HandleItemSubmit = (e) => {
            e.preventDefault();

            setTodoItemList((prev)=>{
              return [...prev, {work:text,id:Date.now(),completed:false}]
            })

            setText("");
          };

          return (
            <form
              id="todo-form"
              onSubmit={HandleItemSubmit}
              className="todoList-ct__Form"
            >
              <input id="todo-input" className="todoList-ct__Form__inputTag" type="text" value={text} onChange={onChange} />
            </form>
          );
        };

        const TodoListItemsContainer = () => {

          return (
            <ul id="todo-list" className="todo-list">
              {todoItemList.map((item) => {
               return <RenderItem todo={item} key={item.id}/>;
              })}
            </ul>
          );
        };

        const TodoListFooter = () => {
          return (
            <div className="footer">
              <p className="footer__text count-item">ì˜¤ëŠ˜ í•  ì¼ 0ê°œ</p>
              <p className="all-item footer__text">ì „ì²´ë³´ê¸°</p>
              <p className="footer__text active-item">ë‚¨ì€ í•  ì¼</p>
              <p className="footer__text completed-item">ì™„ë£Œ í•œ ì¼</p>
            </div>
          );
        };


        const RenderItem = ({todo }) => {

           //ì•„ì´í…œ ì™„ë£Œ
          const HandleCompletedItem = (e) => {
            e.target.closest('li').classList.add('completed');

            setTodoItemList((prev)=>
              prev.map((item)=>{
                if(item.id === todo.id) item.completed = item.completed ? false : true;
                return item;
              })
            )
          };

            //ì•„ì´í…œ ì‚­ì œ
            const HandleItemDelete = (e) => {
              const selectedItem = e.target.closest('li').querySelector('label').innerText;
              setTodoItemList(
                todoItemList.filter((item) => {
                  return selectedItem != item.work;
                }),
              );
            };

          return (
            <li className={`${todo.completed && "completed"}`}>
              <div className="view">
                <input className="toggle" type="checkbox" checked={todo.completed} onChange={HandleCompletedItem}/>
                <label className="label">{todo.work}</label>
                <button onClick={HandleItemDelete} className="destroy">
                  X
                </button>
              </div>
              <input className="edit" />
            </li>

          );
        };

        

        return (
          <div>
            <h2 style={{ color: '' }}>
              {userName[0] ? `${userName[0]}'s JS ğŸ’… React` : 'JS ğŸ’… React'}
            </h2>
            <div className="todoList-ct">
              <TodoListForm/>
              <TodoListItemsContainer/>
              <TodoListFooter/>
            </div>
          </div>
        );
      };
      //jsx? html í…Œê·¸ì™€ jsì˜ í˜¼í•© ì‚¬ìš©
      const ë°”íƒ• = document.querySelector('#app');

      // append í•´ì£¼ëŠ” ê²ƒ ReactDOM render ì¸ì1 = ë„£ì–´ì¤„ì•  ì¸ì2 = ë°”íƒ•
      ReactDOM.render(<App />, ë°”íƒ•);
    </script>
</body>

</html>